var $,root,tweak,wrapper;if(wrapper=function(t,e,n,o){var r;return r=e,e.$=o,e.require=n,e.strict=!1,e.noConflict=function(){return t.tweak=r,this}},root="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||window,"function"==typeof define&&define.amd)define(["$","exports"],function(t,e){var n;return n=function(t){return define([t],function(t){return t})},wrapper(root,root.tweak=e,n,t)});else if("undefined"!=typeof exports){try{$=require("$")}catch(_error){}if(!$)try{$=require("jquery")}catch(_error){}wrapper(root,tweak=exports,require,$)}else wrapper(root,root.tweak={},require,root.jQuery||root.Zepto||root.ender||root.$);tweak.Class=function(){function t(){}return t.prototype.__hasProp={}.hasOwnProperty,t.prototype["extends"]=function(t,e){return function(t,e){var n,o;n=function(){this.constructor=t};for(o in e)this.__hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t}},t.prototype["super"]=function(t,e){return t.__super__[e].call(this)},t}();var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,slice=[].slice;tweak.Events=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.findEvent=function(t,e){var n,o,r,i,s,a;for(null==e&&(e=!1),"string"==typeof t&&(t=t.split(/\s+/)),o=this.__events=this.__events||{},a=[],r=0,s=t.length;s>r;r++){if(i=t[r],!(n=o[i])){if(!e)continue;n=this.__events[i]={name:i,__callbacks:[]}}a.push(n)}return a},e.prototype.addEvent=function(t,e,n,o){var r,i,s,a,l,p,u,c,h;for(null==n&&(n=this),("number"==typeof n||null===n)&&(o=n,n=o||this),c=this.findEvent(t,!0),i=0,p=c.length;p>i;i++){for(r=c[i],s=!1,h=r.__callbacks,l=0,u=h.length;u>l;l++)a=h[l],a.callback===e&&n===a.ctx&&(a.max=o,a.calls=0,a.listen=s=!0);s||r.__callbacks.push({ctx:n,callback:e,max:o,calls:0,listen:!0})}},e.prototype.removeEvent=function(t,e,n){var o,r,i,s,a,l,p;for(null==n&&(n=this),l=this.findEvent(t),r=0,a=l.length;a>r;r++){o=l[r],p=o.__callbacks;for(s in p)i=p[s],null!=e&&e!==i.callback||null!=n&&n!==i.ctx||o.__callbacks.splice(s,1);0===o.__callbacks.length&&delete this.__events[o.name]}},e.prototype.triggerEvent=function(){var t,e,n,o,r,i,s,a,l,p,u;for(a=arguments[0],l=2<=arguments.length?slice.call(arguments,1):[],"object"==typeof a&&!a instanceof Array&&(a=a.names||[],t=a.context||null),p=this.findEvent(a),n=0,i=p.length;i>n;n++)for(e=p[n],u=e.__callbacks,r=0,s=u.length;s>r;r++)o=u[r],!o.listen||null!=t&&t!==o.ctx||(null!=o.max&&++o.calls>=o.max&&(o.listen=!1),setTimeout(function(){this.callback.apply(this.ctx,l)}.bind(o),0))},e.prototype.updateEvent=function(t,e){var n,o,r,i,s,a,l,p,u,c,h,f,d,m;for(null==e&&(e={}),r=e.context,h=e.max,m=e.reset,o=m?0:e.calls||0,c=e.listen,n=e.callback,f=this.findEvent(t),s=0,p=f.length;p>s;s++)for(i=f[s],d=i.__callbacks,l=0,u=d.length;u>l;l++)a=d[l],null!=r&&r===a.ctx||null!=n&&n===a.callback||(null!=h&&(a.max=h),null!=o&&(a.calls=o),null!=c&&(a.listen=c))},e.prototype.resetEvents=function(){return this.__events={}},e}(tweak.Class),tweak.Common=function(){function t(){}return t.prototype.combine=function(t,e){var n,o;for(n in e)o=e[n],"object"==typeof o?(null==t[n]&&(t[n]=o instanceof Array?[]:{}),t[n]=tweak.Common.combine(t[n],o)):t[n]=o;return t},t.prototype.clone=function(t){var e,n;if(null===t||"object"!=typeof t||t===this)return t;if(t instanceof Date)return n=new Date,n.setTime(t.getTime()),n;if(t instanceof Array)n=[];else{if("object"!=typeof t)throw new Error("Unable to copy object, type not supported.");n={}}for(e in t)t.hasOwnProperty(e)&&(n[e]=tweak.Common.clone(t[e]));return n},t.prototype.parse=function(t){return JSON["string"==typeof t?"parse":"stringify"](t)},t.prototype.findModule=function(t,e,n){var o,r,i,s;for(i=0,s=t.length;s>i;i++){o=t[i];try{return tweak.Common.require(o,e)}catch(a){if(r=a,"Error"!==r.name)throw r.message="Module ("+o+"}) found. Encountered "+r.name+": "+r.message,r}}if(null!=n)return n;throw new Error("No default module ("+e+") for component "+t[0])},t.prototype.require=function(t,e,n){var o,r;r=tweak.Common.relToAbs(t,e);try{return tweak.require(r)}catch(i){if(o=i,null!=n)return n;throw o}},t.prototype.splitMultiName=function(t,e){var n,o,r,i,s,a,l,p,u,c;for(c=[],l=/^(.*)\[(\d*)(?:[,\-](\d*)){0,1}\](.*)$/,"string"==typeof e&&(e=e.split(/\s+/)),n=0,r=e.length;r>n;n++)if(o=e[n],p=l.exec(o),null!=p)for(a=p[1],s=p[2]||0,i=p[3]||s,u=p[4];i>=s;)c.push(tweak.Common.relToAbs(t,""+a+s++ +u));else c.push(tweak.Common.relToAbs(t,o));return c},t.prototype.relToAbs=function(t,e){var n;return n=e.split(/\.{2,}[\/\\]*/).length-1||0,t=t.replace(new RegExp("([\\/\\\\]*[^\\/\\\\]+){"+n+"}[\\/\\\\]?$"),""),e.replace(/^(\.+[\/\\]*)+/,t+"/")},t}(),tweak.Common=new tweak.Common;var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,slice=[].slice;tweak.Store=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype._type="BASE",e.prototype.length=0,e.prototype.init=function(){},e.prototype.set=function(){var t,e,n,o,r,i,s,a,l,p;t=arguments[0],r=2<=arguments.length?slice.call(arguments,1):[],l=r[0],p=typeof t,("string"===p||"number"===p)&&(s=t,t={},t[s]=r[0],l=r[1]),o={};for(e in t)a=t[e],i=this._data[e],null==i&&this.length++,this._data[e]=("function"==typeof this[n="__set"+e.replace(/^[a-z]/,function(t){return t.toUpperCase()})]?this[n](a):void 0)||a,l||this.triggerEvent("changed:"+e,a);l||this.triggerEvent("changed")},e.prototype.same=function(t,e){var n,o;for(n in t)if(o=t[n],null==e[n]||e[n]!==o)return!1;return!0},e.prototype.get=function(){var t,e,n,o,r,i,s,a,l,p;for(a=arguments[0],p=2<=arguments.length?slice.call(arguments,1):[],null==a&&(a=function(){var t,e;t=this._data,e=[];for(i in t)o=t[i],e.push(i);return e}.call(this)),("string"==typeof a||"number"==typeof a)&&(a=[a]),t=this._data instanceof Array?[]:{},n=r=0,s=a.length;s>r;n=++r)o=a[n],e="function"==typeof this[l="__get"+(""+o).replace(/^[a-z]/,function(t){return t.toUpperCase()})]?this[l].apply(this,p):void 0,null==e&&(e=this._data[o]),t[o]=e;return 1>=n&&(t=t[o]),t},e.prototype.has=function(t,e){var n,o,r,i,s,a;for(("string"==typeof t||"number"==typeof t)&&(t=[t]),o=i=0,s=t.length;s>i;o=++i)if(r=t[o],n="function"==typeof this[a="__get"+r.replace(/^[a-z]/,function(t){return t.toUpperCase()})]?this[a].apply(this,e):void 0,null==n&&null==this._data[r])return!1;return!0},e.prototype.where=function(t){var e,n,o,r;r=[],e=this._data;for(n in e)o=e[n],o===t&&r.push(n);return r},e.prototype.reset=function(){this.length=0,this.triggerEvent("changed")},e.prototype["import"]=function(t,e){var n,o,r;null==e&&(e=!0);for(o in t)n=t[o],null!=(null!=(r=this._data[o])?r["import"]:void 0)?this._data[o]["import"](n,e):this.set(o,n,e)},e.prototype["export"]=function(t){var e,n,o,r,i;for(i={},null==t&&(t=function(){var t,n;t=this._data,n=[];for(o in t)e=t[o],n.push(o);return n}.call(this)),n=0,r=t.length;r>n;n++)o=t[n],null!=(e=this.get(o))&&(null!=e["export"]?i[o]=e["export"]():i[o]=e);return i},e}(tweak.Events);var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,slice=[].slice;tweak.Collection=function(t){function e(t){this._data=null!=t?t:[]}var n;return extend(e,t),e.prototype._type="collection",n=function(t,e){var n,o;for(o in t)n=t[o],e("changed:"+o,n);return triggerEvent("changed",t)},e.prototype.add=function(t,e){this.set(this.length,t,e)},e.prototype.at=function(t){return this.get(t)},e.prototype.push=function(t,e){this.set(this.length,t,e)},e.prototype.splice=function(t,e,o,r){var i;null==r&&(r=!1),(i=this._data).splice.apply(i,[t,e].concat(slice.call(o))),this.length=this._data.length,r||n(this._data,this.triggerEvent)},e.prototype.insert=function(t,e,n){this.splice(position,0,e,n)},e.prototype.unshift=function(t,e){return this.splice(0,0,t,e),this.length},e.prototype.remove=function(t,e){var n,o,r;for(t instanceof Array||(t=[t]),n=0,r=t.length;r>n;n++)o=t[n],this._data.splice(o,1),e||this.triggerEvent("removed:"+o);e||this.triggerEvent("changed")},e.prototype.removeAt=function(t,e){var n,o,r;n=this.at(t);for(o in n)r=n[o],this.remove(o,e)},e.prototype.pop=function(t){var e,n;return e=this.length-1,n=this._data[e],this.remove(e,t),n},e.prototype.shift=function(t){var e;return e=this._data[0],this.remove(0,t),e},e.prototype.reduce=function(t,e){this.splice(0,t,e)},e.prototype.reduceRight=function(t,e){this.splice(0,this.length-t,e)},e.prototype.indexes=function(t){var e,n,o,r;o=this._data,r=[];for(e in o)n=o[e],t===n&&r.push(e);return r},e.prototype.concat=function(t,e){var n;this.splice(this.length-1,0,(n=[]).concat.apply(n,t),e)},e.prototype.reset=function(){this._data=[],e.__super__.reset.call(this)},e.prototype.every=function(){return this._data.every(arguments)},e.prototype.filter=function(){return this._data.filter(arguments)},e.prototype.forEach=function(){return this._data.forEach(arguments)},e.prototype.join=function(){return this._data.join(arguments)},e.prototype.map=function(){return this._data.map(arguments)},e.prototype.reverse=function(t){var e;return e=this._data.reverse(),t||n(this._data,this.triggerEvent),e},e.prototype.slice=function(){return this._data.slice(arguments)},e.prototype.some=function(){return this._data.some(arguments)},e.prototype.sort=function(t,e){var o;return null==e&&(e=!1),o=null!=t?this._data.sort(t):this._data.sort(),n(this._data,this.triggerEvent),o},e}(tweak.Store);var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;tweak.Components=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype._type="components",e.prototype.init=function(){var t,e,n,o,r,i,s,a,l,p,u,c,h,f,d,m,_;for(this._data=[],e=[],t=this.component.name,_=this.component.config.components,n=0,a=_.length;a>n;n++){if(o=_[n],f={},o instanceof Array)for(h=tweak.Common.splitMultiName(t,o[0]),d=tweak.Common.relToAbs(t,o[1]),r=0,l=h.length;l>r;r++)c=h[r],this._data.push(new tweak.Component(this,{name:c,"extends":d}));else if("string"==typeof o)for(e=tweak.Common.splitMultiName(t,o),i=0,p=e.length;p>i;i++)c=e[i],this._data.push(new tweak.Component(this,{name:c}));else for(f=o,c=f.name,e=tweak.Common.splitMultiName(t,c),f["extends"]=tweak.Common.relToAbs(t,f["extends"]),s=0,u=e.length;u>s;s++)m=e[s],f.name=m,this._data.push(new tweak.Component(this,f));this._data[this.length++].init()}},e.prototype.__componentRender=function(t){var e,n,o,r;if(0===this.length)this.triggerEvent("ready");else for(this.total=0,r=this._data,e=0,o=r.length;o>e;e++)n=r[e],n.controller.addEvent("ready",function(){return++this.total===this.length?this.triggerEvent("ready"):void 0},this,1),n[t]()},e.prototype.render=function(){this.__componentRender("render")},e.prototype.rerender=function(){this.__componentRender("rerender")},e.prototype.whereData=function(t,e){var n,o,r,i,s,a,l;l=[],o=this._data;for(n in o){r=o[n],s=r.model.data||model.data;for(i in s)a=s[i],i===t&&a===e&&l.push(r)}return l},e.prototype.reset=function(){var t,n,o,r;for(r=this._data,t=0,o=r.length;o>t;t++)n=r[t],n.destroy();e.__super__.reset.call(this)},e}(tweak.Collection);var slice=[].slice;tweak.Component=function(){function t(t,e){var n,o,r,i,s,a,l,p,u,c;if(null==e)throw new Error("No options given");if(t=this.relation=t===window?{}:t,null==t.relation&&(t.relation={}),this.parent=t instanceof tweak.Component?t:t.component||t,this.root=this.parent.root||this,this.name=e.name,null==this.name)throw new Error("No name given");for(e.name=this.name=tweak.Common.relToAbs(this.parent.name||"",this.name),this.config=this.__buildConfig(e),this.config.router&&this.__addRouter(),this.__addModel(),this.__addView(),this.__addComponents(),this.__addController(),u=this.modules,n=0,r=u.length;r>n;n++)if(s=u[n],l=this[s])for(l.parent=this.parent,l.component=this,c=this.modules,o=0,i=c.length;i>o;o++)a=c[o],s!==a&&(p=this[a])&&(l[a]=p)}return t.prototype.model=null,t.prototype.view=null,t.prototype.components=null,t.prototype.controller=null,t.prototype.router=null,t.prototype.modules=["controller","model","view","router","components"],t.prototype.init=function(){var t,e,n,o,r;for(r=this.modules,e=0,n=r.length;n>e;e++)o=r[e],"view"!==o&&(t=this[o])&&"function"==typeof t.init&&t.init()},t.prototype.__buildConfig=function(t){var e,n,o,r,i,s,a,l,p,u;for(e=[],s=this.paths=[],n=this.name,t&&(e.push(tweak.Common.clone(t)),t["extends"]&&(n=t["extends"])),i=(null!=(a=this.parent)?a.name:void 0)||this.name;n;)p=tweak.Common.require(i,n+"/config",tweak.strict?null:{}),s.push(tweak.Common.relToAbs(i,n)),e.push(tweak.Common.clone(p)),n=p["extends"];for(u=e[e.length-1],o=r=l=e.length-2;0>=l?0>=r:r>=0;o=0>=l?++r:--r)u=tweak.Common.combine(u,e[o]);return null==u.model&&(u.model={}),null==u.view&&(u.view={}),null==u.controller&&(u.controller={}),null==u.components&&(u.components=[]),null==u.events&&(u.events={}),u},t.prototype.__addModule=function(){var t,e,n,o,r;n=arguments[0],r=arguments[1],o=3<=arguments.length?slice.call(arguments,2):[],t=tweak.Common.findModule(this.paths,"./"+n,r),e=this[n]=function(t,e,n){n.prototype=t.prototype;var o=new n,r=t.apply(o,e);return Object(r)===r?r:o}(t,[this.config[n]].concat(slice.call(o)),function(){}),e.component=this,e.root=this.root},t.prototype.__addView=function(){var t;t=1<=arguments.length?slice.call(arguments,0):[],this.__addModule.apply(this,["view",tweak.View].concat(slice.call(t)))},t.prototype.__addModel=function(){var t;t=1<=arguments.length?slice.call(arguments,0):[],this.__addModule.apply(this,["model",tweak.Model].concat(slice.call(t)))},t.prototype.__addController=function(){var t;t=1<=arguments.length?slice.call(arguments,0):[],this.__addModule.apply(this,["controller",tweak.Controller].concat(slice.call(t)))},t.prototype.__addComponents=function(){var t;t=1<=arguments.length?slice.call(arguments,0):[],this.__addModule.apply(this,["components",tweak.Components].concat(slice.call(t)))},t.prototype.__addRouter=function(){var t;t=1<=arguments.length?slice.call(arguments,0):[],this.__addModule.apply(this,["router",tweak.Router].concat(slice.call(t)))},t.prototype.__componentRender=function(t){this.view.addEvent(t+"ed",function(){return this.components.addEvent("ready",function(){return this.controller.triggerEvent("ready")},this,1),this.components[t]()},this,1),this.view[t]()},t.prototype.render=function(){var t;t=this.name,this.__componentRender("render")},t.prototype.rerender=function(){this.__componentRender("rerender")},t.prototype.destroy=function(t){var e,n,o,r,i,s;if(this.view.clear(),e=this.relation.components,null!=e)for(n=0,s=e.data,r=0,i=s.length;i>r;r++){if(o=s[r],o.uid===this.uid)return void e.remove(n,t);n++}},t.prototype.findEvent=function(t,e){return this.controller.findEvent(t,e)},t.prototype.addEvent=function(t,e,n,o){return this.controller.addEvent(t,e,n,o)},t.prototype.removeEvent=function(t,e,n){return this.controller.removeEvent(t,e,n)},t.prototype.triggerEvent=function(){var t,e,n;return t=arguments[0],e=2<=arguments.length?slice.call(arguments,1):[],(n=this.controller).triggerEvent.apply(n,[t].concat(slice.call(e)))},t.prototype.updateEvent=function(t,e){return this.controller.updateEvent(t,e)},t.prototype.resetEvents=function(){return this.controller.resetEvents()},t.prototype["export"]=function(t){var e;return("function"==typeof(e=this.controller)["export"]?e["export"]():void 0)||{model:this.model["export"](t,{components:this.components["export"]()})}},t.prototype["import"]=function(t){return null!=this.controller["import"]?this.controller["import"](t):(t.model&&this.model["import"](t.model),t.components?this.components["import"](t.components):void 0)},t}();var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;tweak.Controller=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.init=function(){},e}(tweak.Events);var bind=function(t,e){return function(){return t.apply(e,arguments)}},extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;tweak.History=function(t){function e(){this.__checkChanged=bind(this.__checkChanged,this),"undefined"!=typeof window&&(this.location=(this.window=window).location,this.history=window.history)}var n;return extend(e,t),e.prototype.usePush=!0,e.prototype.useHash=!1,e.prototype.started=!1,e.prototype.root="/",e.prototype.iframe=null,e.prototype.url=null,e.prototype.__interval=null,e.prototype.intervalRate=50,e.prototype.start=function(t){var e,n,o,r,i,s,a,l;return null==t&&(t={}),this.started?void 0:(this.started=!0,l=this.usePush=t.useHash?!1:null!=(r=this.history)?r.pushState:void 0,a=this.useHash=!l,(t.forceRefresh||a&&!("onhashchange"in this.window))&&(this.usePush=this.useHash=a=l=!1),t.interval&&(this.intervalRate=t.interval),this.root=i=("/"+(t.root||"/")+"/").replace(/^\/+|\/+$/g,"/"),this.url=s=this.__getURL(),o=this.location,a?this.location.replace(i+"#"+this.__getPath()+this.__getHash()):l&&""!==this.__getHash()&&this.set(this.__getHash(),{replace:!0}),l||a||t.forceRefresh||(n=document.createElement("iframe"),n.src="javascript:0",n.style.display="none",n.tabIndex=-1,e=document.body,this.iframe=e.insertBefore(n,e.firstChild).contentWindow,this.__setHash(this.iframe,"#"+s,!1)),this.__toggleListeners(),t.silent?void 0:this.triggerEvent("changed",this.url.replace(/^\/+/,"")))},e.prototype.stop=function(){return this.__toggleListeners("remvoe"),this.started=!1},e.prototype.set=function(t,e){var n,o,r;if(null==e&&(e={}),this.started&&(null==e.silent&&(e.silent=!0),o=e.replace,t=this.__getURL(t)||"",r=this.root,(""===t||"?"===t.charAt(0))&&(r=r.slice(0,-1)||"/"),n=""+r+t.replace(/^\/*/,""),t=decodeURI(t.replace(/#.*$/,"")),this.url!==t)){if(this.url=t,this.usePush)this.history[o?"replaceState":"pushState"]({},document.title,n);else{if(!this.useHash)return void this.location.assign(fullURL);this.__setHash(this.window,t,o),this.iframe&&t!==this.__getHash(this.iframe)&&this.__setHash(this.iframe,t,o)}e.silent||this.triggerEvent("changed",(this.url=t).replace(/^\/+/,""))}},n=function(t,e,n){var o;return window.addEventListener?element[t+"EventListener"](e,n):window.attachEvent?(o="on"===t?"attach":"detach",element[o+"Event"]("prefix"+e,n)):element[t+e]=n},e.prototype.__toggleListeners=function(t){null==t&&(t="add"),this.pushState?n("popstate",this.__checkChanged):this.useHash&&!this.iframe?n("hashchange",this.__checkChanged):this.useHash&&("add"===t?this.__interval=setInterval(this.__checkChanged,this.intervalRate):(clearInterval(this.__interval),document.body.removeChild(this.iframe.frameElement),this.iframe=this.__interval=null))},e.prototype.__getHash=function(t){var e;return e=(t||this).location.href.match(/#(.*)$/),e?e[1]:""},e.prototype.__getSearch=function(){var t;return t=this.location.href.replace(/#.*/,"").match(/\?.+/),t?t[0]:""},e.prototype.__getPath=function(){var t,e;return t=decodeURI(""+this.location.pathname+this.__getSearch()),e=this.root.slice(0,-1),t.indexOf(e)||(t=t.slice(e.length)),"/"===t.charAt(0)?t.slice(1):t},e.prototype.__getURL=function(t,e){var n;return null==t&&(this.usePush||e?(t=decodeURI(""+this.location.pathname+this.location.search),n=this.root.replace(/\/$/,""),t.indexOf(n)||(t=t.slice(n.length))):t=this.__getHash()),t=t.replace(/^\/{2,}/g,"/"),t.match(/^\/+/)||(t="/"+t),t.replace(/\/+$/g,"")},e.prototype.__setHash=function(t,e,n){this.iframe===t&&t.document.open().close(),n?t.location.replace(location.href.replace(/(javascript:|#).*$/,"")+"#"+e):t.location.hash=""+e},e.prototype.__checkChanged=function(){var t,e;if(t=this.__getURL(),e=this.url,t===e){if(!this.iframe)return!1;t=this.__getHash(this.iframe),this.set(t)}return this.triggerEvent("changed",this.url=t),!0},e}(tweak.Events),tweak.History=new tweak.History;var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;tweak.Model=function(t){function e(t){this._data=null!=t?t:{}}return extend(e,t),e.prototype._type="model",e.prototype.remove=function(t,e){var n,o,r,i,s,a;for("string"==typeof t&&(t=[t]),n=0,r=t.length;r>n;n++){s=t[n],a=this._data;for(o in a)i=a[o],o===s&&(this.length--,delete this._data[o],e||this.triggerEvent("removed:"+o))}e||this.triggerEvent("changed")},e.prototype.pluck=function(t){var e,n,o,r;r=[],o=this._data;for(e in o)n=o[e],n===t&&r.push(e);return r},e.prototype.reset=function(){this._data={},e.__super__.reset.call(this)},e}(tweak.Store);var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;tweak.Router=function(t){function e(t){this.routes=null!=t?t:{},tweak.History.addEvent("changed",this.__urlChanged,this)}var n,o,r,i;return extend(e,t),e.prototype.uid=0,e.prototype["super"]=tweak["super"],e.prototype.add=function(t,e){null!=this.routes[t]?this.routes[t].push(e):this.routes[t]=[e]},e.prototype.remove=function(t,e){var n,o,r,i,s,a;if(a=this.routes[t],"string"==typeof e)for(i=(" "+e.replace(/\s+/g," ")+" ").split(" "),n=0,r=i.length;r>n;n++)s=i[n],a=(" "+a.join(" ")+" ").split(" "+s+" ");else for(o in a)s=a[o],s===e&&delete a[o];this.routes[t]=a,null==a||null!=e&&0!==a.length||delete this.routes[t]},r=/\/?[?:]([^?\/:]*)/g,o=function(t){var e,n,o,r,i,s,a,l;if(l=/^.*\?(.+)/.exec(t)){if(i=/([^&]+)&*/.exec(l[1]))for(e=0,o=i.length;o>e;e++)r=i[e],t={},a=/(.+)[:=]+(.+)|(.+)/.exec(t),a&&(n=a[3]||a[1],s=a[2]||"true",t[n]=s)}else t&&(t=t.replace(/\?/g,""));return t},i=function(t){var e,n;return e=/[\-\\\^\[\]\s{}+.,$|#]/g,n=/\/?(\*)$/,t=t.replace(e,"\\$&"),t=t.replace(r,function(t){var e;return e="\\/?([^\\/]*?)",/^\/?\?/.exec(t)?"(?:"+e+")?":e}),t=t.replace(n,"\\/?(.*?)"),new RegExp("^"+t+"[\\/\\s]?$")},n=function(t){var e;return e=t.match(r)||[],e.push("splat"),e},e.prototype.__urlChanged=function(t){var e,r,s,a,l,p,u,c,h,f;t=t.replace(/^\/+|\/+$/g,""),p=this.routes,c=[];for(e in p)f=p[e],c.push(function(){var p,c,d,m,_,y;for(y=[],p=0,d=f.length;d>p;p++)if(h=f[p],a=[],"string"==typeof h&&(a=n(h),h=i(h)),l=h.exec(t)){for(u={url:t,data:{}},l.splice(0,1),s=0,c=0,m=l.length;m>c;c++)r=l[c],u.data[(null!=(_=a[s])?_.replace(/^[?:\/]*/,""):void 0)||s]=o(r),s++;y.push(this.triggerEvent(e,u))}else y.push(void 0);return y}.call(this));return c},e}(tweak.Events);var extend=function(t,e){function n(){this.constructor=t}for(var o in e)hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;tweak.View=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n;return extend(e,t),n=tweak.$,e.prototype.init=function(){},e.prototype.template=function(){var t;return t=this.component.config.view||{},(t.template?tweak.Common.require(t.template):tweak.Common.findModule(this.component.paths,"./template"))(t.data||this.model._data)},e.prototype.attach=function(t,e){var o,r,i,s,a,l,p,u,c;switch(e=n(e)[0],a=null!=(p=this.component.config.view)&&null!=(u=p.attach)?u.method:void 0){case"prefix":case"before":return t.insertBefore(e,t.firstChild),t.firstElementChild;case"replace":for(c=t.children,r=0,s=c.length;s>r;r++){i=c[r];try{t.removeChild(i)}catch(h){o=h}}return t.appendChild(e),t.firstElementChild;default:return/^\d+$/.test(""+a)?(l=Number(a),t.insertBefore(e,t.children[l]),t.children[l]):(t.appendChild(e),t.lastElementChild)}},e.prototype.isAttached=function(t,e){return null==t&&(t=this.el),null==e&&(e=document.documentElement),e.contains(t)},e.prototype.render=function(t){var e,o,r,i,s,a,l,p,u,c,h;return this.isAttached()&&!t?this.triggerEvent("rendered"):(s=this.component.config.view,e=function(t){return function(e){var o,r,i,a;return r=null,e?(o=function(e){var n,o,s,a,l,p;for(l=[],o=0,s=e.length;s>o&&(a=e[o],!r);o++)n=a.getAttribute("data-attach"),null==n||n.match(/\s+/)?l.push(void 0):l.push(function(){var t,e,o,s;for(o=tweak.Common.splitMultiName(this.component.parent.name||"",n),s=[],t=0,e=o.length;e>t;t++){if(p=o[t],i===p){r=a;break}s.push(void 0)}return s}.call(t));return l},i=(null!=(a=s.attach)?a.to:void 0)||t.component.name,o(e),o(n("[data-attach]",e)),r):void 0}}(this),o=(null!=s&&null!=(u=s.attach)?u.to:void 0)||this.component.name,p=null!=(c=this.component.parent)&&null!=(h=c.view)?h.el:void 0,r=e(p)||e(document.documentElement)||p||document.documentElement,this.$el=n(this.attach(r,this.template())),this.el=this.$el[0],l=tweak.Common.clone(this.component.paths),-1===l.indexOf(this.component.name)&&l.unshift(this.component.name),i=function(){var t,e,n;for(n=[],t=0,e=l.length;e>t;t++)a=l[t],n.push(a.replace(/[\/\\]/g,"-"));return n}(),this.$el.addClass(i.join(" ")),t||this.triggerEvent("rendered"),void this.init())},e.prototype.clear=function(t){null==t&&(t=this.el),n(t).remove()},e.prototype.element=function(t,e){var o,r,i,s;if(null==e&&(e=this.el),t instanceof Array){for(s=[],o=0,i=t.length;i>o;o++)r=t[o],s.push(n(r,e));return s}return n(t,e)},e}(tweak.Events);
//# sourceMappingURL=tweak.min.js.map